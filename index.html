<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Election Models</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">

  <style>
    /* ---------- Theme ---------- */
    :root{
      --bg: #05090e; /* Slightly deeper black-blue */
      --panel: #0d1420;
      --panel2: #0a101a;
      --text: #e7eef6;
      --text-dim: #8b9bb4;
      --muted: #64748b;
      
      --border: rgba(255,255,255,0.08);
      --border-light: rgba(255,255,255,0.04);
      --inner-glow: inset 0 1px 0 0 rgba(255,255,255,0.05); /* "Cut glass" top edge */
      
      --shadow: 0 20px 40px -10px rgba(0,0,0,0.6);
      --shadow-sm: 0 4px 12px rgba(0,0,0,0.3);
      
      --radius: 20px;
      --radius-sm: 14px;
      
      --accent: #38bdf8;
      --accent-glow: rgba(56,189,248,0.25);
      --accent2: #f472b6;
      --focus: rgba(56,189,248,0.6);
      
      --glass: rgba(10,16,26,0.75);
      --glass-solid: rgba(10,16,26,0.95);
      
      /* Transitions */
      --ease: cubic-bezier(0.2, 0, 0, 1);
    }
    
    [data-theme="light"]{
      --bg: #f0f4f8;
      --panel: #ffffff;
      --panel2: #f7f9fc;
      --text: #0f172a;
      --text-dim: #475569;
      --muted: #94a3b8;
      
      --border: rgba(0,0,0,0.08);
      --border-light: rgba(0,0,0,0.04);
      --inner-glow: inset 0 1px 0 0 rgba(255,255,255,0.8);
      
      --shadow: 0 20px 40px -12px rgba(148, 163, 184, 0.3);
      --shadow-sm: 0 4px 12px rgba(148, 163, 184, 0.15);
      
      --glass: rgba(255,255,255,0.85);
      --glass-solid: rgba(255,255,255,0.95);
    }

    /* ---------- Base ---------- */
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    
    body{
      margin: 0;
      font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      overflow: hidden;
      -webkit-font-smoothing: antialiased;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font-family:inherit; color:inherit; }

    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 99px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--muted); }

    /* Code styling */
    code{
      font-family: ui-monospace, SFMono-Regular, monospace;
      font-size: 0.85em;
      padding: 2px 6px;
      border-radius: 6px;
      background: rgba(125,125,125,0.1);
      color: var(--text);
    }

    /* Background FX */
    .bgfx{
      position: fixed; inset: 0; pointer-events: none; z-index: -1;
      background:
        radial-gradient(1000px 1000px at 0% 0%, rgba(56,189,248,0.08), transparent 60%),
        radial-gradient(800px 800px at 100% 0%, rgba(244,114,182,0.06), transparent 60%),
        radial-gradient(1200px 800px at 50% 100%, rgba(56,189,248,0.05), transparent 50%);
      filter: blur(40px) saturate(140%);
      animation: pulseBg 10s ease-in-out infinite alternate;
    }
    @keyframes pulseBg {
      0% { opacity: 0.8; transform: scale(1); }
      100% { opacity: 1; transform: scale(1.05); }
    }

    .noise{
      position: fixed; inset: 0; pointer-events: none; z-index: -1; opacity: 0.04;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 400'%3E%3Cfilter id='a'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23a)' opacity='1'/%3E%3C/svg%3E");
    }
    [data-theme="light"] .noise{ opacity: 0.03; mix-blend-mode: multiply; }

    /* ---------- Layout ---------- */
    .wrap{ height: 100%; display: flex; flex-direction: column; }
    
    /* Header */
    header.topbar{
      position: sticky; top: 0; z-index: 30;
      display: flex; align-items: center; justify-content: space-between; gap: 16px;
      height: 64px; padding: 0 20px;
      border-bottom: 1px solid var(--border);
      background: var(--glass);
      backdrop-filter: blur(12px);
      box-shadow: var(--inner-glow);
    }
    
    .brand{ display: flex; align-items: center; gap: 14px; min-width: 0; }
    .logo{
      width: 32px; height: 32px; border-radius: 10px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 15px var(--accent-glow);
      flex-shrink: 0;
      position: relative;
    }
    .logo::after{
      content:""; position:absolute; inset:1px; background:var(--bg); border-radius:9px; opacity:0.2;
    }

    .brandText{ min-width: 0; display:flex; flex-direction:column; justify-content:center; }
    .title{ margin: 0; font-size: 15px; font-weight: 700; letter-spacing: -0.01em; color: var(--text); }
    .subtitle{ margin: 0; font-size: 12px; color: var(--text-dim); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    .right{ display: flex; align-items: center; gap: 8px; }

    /* Universal Buttons/Pills */
    .pill{
      display: inline-flex; align-items: center; gap: 6px;
      padding: 0 12px; height: 32px;
      border-radius: 99px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.03);
      color: var(--text-dim);
      font-size: 12px; font-weight: 500;
      box-shadow: var(--inner-glow);
    }
    .pill b{ color: var(--text); }

    .iconBtn{
      width: 34px; height: 34px;
      display: grid; place-items: center;
      border-radius: 10px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-dim);
      cursor: pointer;
      transition: all 0.2s var(--ease);
    }
    .iconBtn:hover{ background: rgba(255,255,255,0.05); color: var(--text); }
    .iconBtn:active{ transform: scale(0.96); }
    
    .repoLink{
      display: inline-flex; align-items: center; gap: 8px;
      height: 34px; padding: 0 14px;
      border-radius: 99px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.03);
      color: var(--text);
      font-size: 12px; font-weight: 500;
      transition: all 0.2s var(--ease);
    }
    .repoLink:hover{ border-color: var(--muted); background: rgba(255,255,255,0.06); }

    /* Layout Grid */
    .layout{
      flex: 1;
      display: grid;
      grid-template-columns: 320px 1fr; /* Slightly narrower sidebar */
      gap: 16px;
      padding: 16px;
      min-height: 0;
      max-width: 1800px; margin: 0 auto; width: 100%;
    }

    /* ---------- Sidebar ---------- */
    aside.side{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%);
      box-shadow: var(--shadow);
      display: flex; flex-direction: column;
      min-height: 0;
      backdrop-filter: blur(20px);
    }

    .sideTop{
      padding: 16px 16px 12px;
      border-bottom: 1px solid var(--border);
      background: var(--glass-solid);
    }
    
    .searchRow{
      position: relative;
      display: flex; align-items: center;
      background: rgba(0,0,0,0.2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 0 12px;
      height: 38px;
      transition: border-color 0.2s;
    }
    [data-theme="light"] .searchRow{ background: rgba(0,0,0,0.03); }
    .searchRow:focus-within{ border-color: var(--accent); box-shadow: 0 0 0 1px var(--accent); }
    
    .searchRow svg{ color: var(--muted); flex-shrink: 0; }
    .searchRow input{
      width: 100%; border: none; background: transparent; color: var(--text);
      font-size: 13px; font-family: inherit; outline: none; padding-left: 10px;
    }
    .searchRow input::placeholder{ color: var(--muted); }

    .hint{ margin: 12px 0 0; font-size: 11px; color: var(--muted); line-height: 1.4; }

    .list{ padding: 10px; overflow-y: auto; min-height: 0; flex: 1; }
    
    .group{
      display: flex; align-items: center; justify-content: space-between;
      margin: 16px 8px 8px;
      font-size: 10px; font-weight: 700; color: var(--muted);
      letter-spacing: 0.08em; text-transform: uppercase;
    }
    .group:first-child{ margin-top: 4px; }
    .group .count{
      background: rgba(255,255,255,0.05); padding: 2px 6px;
      border-radius: 6px; font-variant-numeric: tabular-nums;
    }

    .item{
      width: 100%; text-align: left;
      display: flex; gap: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-dim);
      cursor: pointer;
      margin-bottom: 2px;
      transition: all 0.15s var(--ease);
      position: relative;
    }
    
    /* Hover State */
    .item:hover{
      background: rgba(255,255,255,0.03);
      color: var(--text);
    }
    
    /* Active State - enhanced */
    .item[aria-current="page"]{
      background: linear-gradient(90deg, rgba(56,189,248,0.08), transparent);
      border: 1px solid rgba(56,189,248,0.15);
      color: var(--text);
    }
    .item[aria-current="page"]::before{
      content: ""; position: absolute; left: 0; top: 12px; bottom: 12px;
      width: 3px; background: var(--accent); border-radius: 0 4px 4px 0;
      box-shadow: 2px 0 12px var(--accent-glow);
    }

    .dot{
      width: 8px; height: 8px; border-radius: 50%;
      margin-top: 7px; flex-shrink: 0;
      background: var(--muted);
      transition: background 0.2s;
    }
    .item[aria-current="page"] .dot{ background: var(--accent); box-shadow: 0 0 8px var(--accent-glow); }
    .dot.us{ background: #38bdf8; }
    .dot.eu{ background: #f472b6; }

    .meta{ flex: 1; min-width: 0; }
    .name{ font-size: 13px; font-weight: 600; margin: 0 0 2px; color: inherit; }
    .desc{ font-size: 12px; color: var(--muted); margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; opacity: 0.8; }
    
    .tags{ display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px; }
    .tag{
      font-size: 10px; font-weight: 500;
      padding: 3px 8px; border-radius: 6px;
      background: rgba(0,0,0,0.15); color: var(--muted);
      border: 1px solid var(--border-light);
    }

    .sideFooter{
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      background: var(--glass-solid);
      font-size: 11px; color: var(--muted);
      display: flex; justify-content: space-between; align-items: center;
    }
    .kbd .key{
      display: inline-block; padding: 2px 6px;
      border: 1px solid var(--border); border-radius: 6px;
      background: rgba(255,255,255,0.05); color: var(--text-dim);
      font-family: inherit; font-size: 10px; margin-left: 2px;
    }

    /* ---------- Main ---------- */
    main.main{
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: var(--panel2);
      box-shadow: var(--shadow);
      display: flex; flex-direction: column;
      overflow: hidden;
      position: relative;
    }

    .mainHead{
      display: flex; align-items: center; justify-content: space-between; gap: 16px;
      padding: 12px 20px;
      border-bottom: 1px solid var(--border);
      background: var(--glass-solid);
      backdrop-filter: blur(12px);
      z-index: 10;
    }
    
    .current h2{ margin: 0; font-size: 14px; font-weight: 700; }
    .current p{ margin: 2px 0 0; font-size: 12px; color: var(--muted); }

    .btn{
      display: inline-flex; align-items: center; gap: 8px;
      height: 32px; padding: 0 14px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.02);
      color: var(--text);
      font-size: 12px; font-weight: 500;
      cursor: pointer;
      transition: all 0.2s var(--ease);
    }
    .btn:hover{ background: rgba(255,255,255,0.05); border-color: var(--muted); }
    .btn:active{ transform: translateY(1px); }
    
    .btn.primary{
      background: rgba(56,189,248,0.1);
      border-color: rgba(56,189,248,0.3);
      color: #38bdf8;
    }
    .btn.primary:hover{
      background: rgba(56,189,248,0.2);
      border-color: rgba(56,189,248,0.5);
      box-shadow: 0 0 15px rgba(56,189,248,0.15);
    }

    /* Iframe Container */
    .frameWrap{
      flex: 1; position: relative; min-height: 0;
      background: var(--bg); /* Match body bg to seamless blend */
    }
    iframe{ width: 100%; height: 100%; border: 0; opacity: 0; transition: opacity 0.3s; }
    .frameWrap.done iframe{ opacity: 1; }

    /* Loading Bar */
    .loadbar{
      position: absolute; left: 0; top: 0; height: 2px; width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      z-index: 20; box-shadow: 0 2px 8px var(--accent-glow);
      opacity: 0; transition: opacity 0.2s;
    }
    .loading .loadbar{ opacity: 1; animation: load 1.2s cubic-bezier(0.2,0,0,1) forwards; }
    @keyframes load{ 0%{width:0%} 50%{width:70%} 100%{width:95%} }

    /* Mobile Nav */
    .mobileNav{ display: none; padding: 0 16px 12px; background: var(--glass-solid); border-bottom: 1px solid var(--border); }
    details{ border: 1px solid var(--border); border-radius: 12px; background: rgba(255,255,255,0.03); overflow: hidden; }
    summary{ padding: 12px; font-weight: 600; cursor: pointer; display: flex; justify-content: space-between; align-items: center; list-style: none; }
    summary::-webkit-details-marker{ display: none; }
    
    /* Responsive */
    @media (max-width: 900px){
      .layout{ grid-template-columns: 1fr; padding: 10px; gap: 10px; }
      aside.side{ display: none; }
      .mobileNav{ display: block; }
      .frameWrap{ min-height: 75vh; }
    }
  </style>
</head>
<body>
  <div class="bgfx"></div>
  <div class="noise"></div>

  <div class="wrap" id="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="brandText">
          <h1 class="title">Election Models</h1>
          <p class="subtitle" id="subtitle">Dashboard</p>
        </div>
      </div>

      <div class="right">
        <span class="pill">
          <b id="pillName">Loading...</b>
          <span id="pillGroup" aria-hidden="true"></span>
        </span>

        <button class="iconBtn" id="themeBtn" type="button" aria-label="Toggle theme" title="Toggle theme (T)">
          <svg id="themeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg>
        </button>

        <a class="repoLink" href="https://github.com/t0lg-a/election" target="_blank" rel="noopener noreferrer">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right:2px"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
          Repo
        </a>
      </div>
    </header>

    <div class="layout" role="application">
      <aside class="side">
        <div class="sideTop">
          <div class="searchRow">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            <input id="search" type="search" placeholder="Filter models..." autocomplete="off" />
          </div>
          <p class="hint">Select a model to visualize data. Deep-link supported.</p>
        </div>
        <div class="list" id="list"></div>
        <div class="sideFooter">
          <span>Navigation</span>
          <span class="kbd"><span class="key">/</span><span class="key">T</span><span class="key">↑↓</span></span>
        </div>
      </aside>

      <main class="main">
        <div class="mobileNav">
          <details id="picker">
            <summary>
              <span id="mobileSummary">Pick a model</span>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </summary>
            <div class="list" id="mobileList" style="max-height:40vh;"></div>
          </details>
        </div>

        <div class="mainHead">
          <div class="current">
            <h2 id="currentName">Model Name</h2>
            <p id="currentDesc">Description goes here.</p>
          </div>
          <div class="actions">
            <a class="btn primary" id="openNew" href="#" target="_blank">
              Open
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
            </a>
            <button class="btn" id="reload">
              Reload
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6"></path><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
            </button>
          </div>
        </div>

        <div class="frameWrap" id="frameWrap">
          <div class="loadbar"></div>
          <iframe id="frame" title="Model viewer"></iframe>
        </div>
      </main>
    </div>
  </div>

  <script>

    const pages = [
      { id:"us",      group:"United States", dot:"us", name:"US Federal", desc:"House + Senate map, swing controls.", href:"./us.html",     tags:["House","Senate","Map"] },
      { id:"midterm", group:"United States", dot:"us", name:"Midterm",    desc:"Midterm model page (national + state).",  href:"./midterm.html", tags:["Map","Controls"] },
      { id:"texas",   group:"United States", dot:"us", name:"Texas",      desc:"Texas state-level model page.",            href:"./texas.html",  tags:["State","Map"] },
      { id:"polling", group:"United States", dot:"us", name:"Polling",    desc:"Aggregate polling data & charts.",         href:"./polling.html",tags:["Data","Charts"] },
{ id:"baylor", group:"United States", dot:"us",
  name:"Baylor",
  desc:"Baylor basketball dashboard (schedule + bid odds).",
  href:"./baylor.html",
  tags:["NCAA","Baylor","Charts"]
},
      { id:"turkey",  group:"Europe",        dot:"eu", name:"Turkey",     desc:"Turkey model page.",                       href:"./turkey.html", tags:["Seats","Map"] },
      { id:"france",  group:"Europe",        dot:"eu", name:"France",     desc:"National-to-local ratios on real map.",    href:"./france.html", tags:["Seats","Map"] },
      { id:"germany", group:"Europe",        dot:"eu", name:"Germany",    desc:"Bundestag-style model page.",              href:"./germany.html",tags:["Seats","Map"] },
    ];

    const $ = (id) => document.getElementById(id);
    const els = {
      list: $("list"), mobileList: $("mobileList"), search: $("search"),
      frame: $("frame"), frameWrap: $("frameWrap"),
      cName: $("currentName"), cDesc: $("currentDesc"),
      sub: $("subtitle"), mobSum: $("mobileSummary"),
      pName: $("pillName"), pGroup: $("pillGroup"),
      btnNew: $("openNew"), btnReload: $("reload"),
      picker: $("picker"), themeBtn: $("themeBtn"), themeIcon: $("themeIcon")
    };

    // State
    let currentPageId = null;

    function renderList(){
      const grouped = {};
      pages.forEach(p => {
        if(!grouped[p.group]) grouped[p.group] = [];
        grouped[p.group].push(p);
      });

      const buildItems = (container, isMobile) => {
        container.innerHTML = "";
        for (const [g, items] of Object.entries(grouped)){
          if(!isMobile){
            const h = document.createElement("div");
            h.className = "group";
            h.innerHTML = `<span>${g}</span><span class="count">${items.length}</span>`;
            container.appendChild(h);
          }
          items.forEach(p => {
            const btn = document.createElement("button");
            btn.className = "item";
            btn.dataset.id = p.id;
            btn.dataset.search = [p.group, p.name, p.desc, ...p.tags].join(" ").toLowerCase();
            btn.innerHTML = `
              <span class="dot ${p.dot}"></span>
              <span class="meta">
                <div class="name">${p.name}</div>
                <div class="desc">${p.desc}</div>
                ${!isMobile ? `<div class="tags">${p.tags.map(t=>`<span class="tag">${t}</span>`).join("")}</div>` : ""}
              </span>
            `;
            btn.onclick = () => select(p.id, isMobile);
            container.appendChild(btn);
          });
        }
      };

      buildItems(els.list, false);
      buildItems(els.mobileList, true);
    }

    function select(id, closeMobile = false){
      const p = pages.find(x => x.id === id) || pages[0];
      currentPageId = p.id;

      // Update Active State
      document.querySelectorAll('.item').forEach(el => {
        if(el.dataset.id === id) el.setAttribute("aria-current", "page");
        else el.removeAttribute("aria-current");
      });

      // Update Text
      els.cName.textContent = p.name;
      els.cDesc.textContent = p.desc;
      els.sub.textContent = `${p.group} / ${p.name}`;
      els.mobSum.textContent = p.name;
      els.pName.textContent = p.name;
      els.pGroup.textContent = ` • ${p.group}`;
      els.btnNew.href = p.href;

      // Load Frame
      if(els.frame.getAttribute("src") !== p.href){
        els.frameWrap.classList.remove("done");
        els.frameWrap.classList.add("loading");
        els.frame.src = p.href;
      }

      // History & Storage
      if(location.hash !== "#"+id) history.replaceState(null,"","#"+id);
      try{ localStorage.setItem("dash:last", id); }catch(e){}

      if(closeMobile && els.picker.open) els.picker.open = false;
    }

    function setTheme(t){
      document.documentElement.setAttribute("data-theme", t);
      localStorage.setItem("dash:theme", t);
      // Sun/Moon Icons
      els.themeIcon.innerHTML = t === "light" 
        ? `<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>` 
        : `<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>`;
    }

    function toggleTheme(){
      const cur = document.documentElement.getAttribute("data-theme") === "dark" ? "light" : "dark";
      setTheme(cur);
    }

    // Init
    renderList();
    
    // Theme Init
    const savedTheme = localStorage.getItem("dash:theme") || (window.matchMedia("(prefers-color-scheme: light)").matches ? "light" : "dark");
    setTheme(savedTheme);

    // Route Init
    const hash = (location.hash || "").replace("#","");
    const last = localStorage.getItem("dash:last");
    select(hash || last || pages[0].id);

    // Events
    els.search.oninput = (e) => {
      const q = e.target.value.toLowerCase();
      document.querySelectorAll(".item").forEach(el => {
        el.style.display = el.dataset.search.includes(q) ? "flex" : "none";
      });
      // Hide empty groups
      document.querySelectorAll(".group").forEach(g => {
        let n = g.nextElementSibling;
        let hasVis = false;
        while(n && !n.classList.contains("group")){
          if(n.style.display !== "none") hasVis = true;
          n = n.nextElementSibling;
        }
        g.style.display = hasVis ? "flex" : "none";
      });
    };

    els.frame.onload = () => {
      els.frameWrap.classList.remove("loading");
      els.frameWrap.classList.add("done");
    };

    els.btnReload.onclick = () => {
      els.frameWrap.classList.remove("done");
      els.frameWrap.classList.add("loading");
      els.frame.src = els.frame.src;
    };

    els.themeBtn.onclick = toggleTheme;

    window.onkeydown = (e) => {
      if(e.key === "/" && document.activeElement !== els.search){
        e.preventDefault(); els.search.focus();
      }
      if(e.key.toLowerCase() === "t" && document.activeElement.tagName !== "INPUT"){
        toggleTheme();
      }
    };
  </script>
</body>
</html>
